<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:media="http://search.yahoo.com/mrss/"><channel><title><![CDATA[Monitoring - Hello Koding - Practical Coding Courses, Tutorials and Examples]]></title><description><![CDATA[Practical coding courses, tutorials and examples series of Data Structure, Algorithm Interview Questions, Spring, Java, JPA/Hibernate and REST API]]></description><link>http://hellokoding.com/</link><generator>Ghost 0.9</generator><lastBuildDate>Thu, 19 Sep 2019 13:35:28 GMT</lastBuildDate><atom:link href="http://hellokoding.com/tag/monitoring/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Java Application Health Check with Prometheus, Grafana, MySQL and Docker Compose]]></title><description><![CDATA[<p>This tutorial walks you through the steps of creating a Java Application Health Check Example with Prometheus, Grafana, MySQL and Docker Compose.</p>

<h3 id="whatyoullneed">What you'll need</h3>

<ul>
<li>Docker CE 18+</li>
</ul>

<h3 id="stack">Stack</h3>

<ul>
<li>Java</li>
<li>Prometheus</li>
<li>Grafana</li>
<li>MySQL</li>
<li>Docker Compose</li>
</ul>

<h2 id="initprojectstructureanddependencies">Init project structure and dependencies</h2>

<h3 id="projectstructure">Project structure</h3>

<pre><code class="language-bash">├── src
│   └── main
│       └── java
│           └── com
│               └── hellokoding
│                   └── monitoring
│                       ├── Application.java</code></pre>]]></description><link>http://hellokoding.com/java-application-health-check-with-prometheus-grafana-mysql-and-docker-compose/</link><guid isPermaLink="false">0fa5f64c-b029-4a0a-a793-085e7f4f3f56</guid><category><![CDATA[Monitoring]]></category><category><![CDATA[Java]]></category><dc:creator><![CDATA[Giau Ngo]]></dc:creator><pubDate>Wed, 09 Jan 2019 15:25:10 GMT</pubDate><media:content url="http://hellokoding.com/content/images/2019/01/Screenshot-2019-01-09-at-11-24-39-PM.png" medium="image"/><content:encoded><![CDATA[<img src="http://hellokoding.com/content/images/2019/01/Screenshot-2019-01-09-at-11-24-39-PM.png" alt="Java Application Health Check with Prometheus, Grafana, MySQL and Docker Compose"><p>This tutorial walks you through the steps of creating a Java Application Health Check Example with Prometheus, Grafana, MySQL and Docker Compose.</p>

<h3 id="whatyoullneed">What you'll need</h3>

<ul>
<li>Docker CE 18+</li>
</ul>

<h3 id="stack">Stack</h3>

<ul>
<li>Java</li>
<li>Prometheus</li>
<li>Grafana</li>
<li>MySQL</li>
<li>Docker Compose</li>
</ul>

<h2 id="initprojectstructureanddependencies">Init project structure and dependencies</h2>

<h3 id="projectstructure">Project structure</h3>

<pre><code class="language-bash">├── src
│   └── main
│       └── java
│           └── com
│               └── hellokoding
│                   └── monitoring
│                       ├── Application.java
│                       ├── DbHealthCheck.java
│                       └── HealthCheckExporter.java
├── Dockerfile
├── docker-compose.yaml
├── pom.xml
└── prometheus.yml
</code></pre>

<h3 id="projectdependencies">Project dependencies</h3>

<pre><code class="language-xml embedfile-https://github.com/hellokoding/hellokoding-courses/blob/master/java-examples/java-app-healthcheck-prometheus/pom.xml">
</code></pre>

<h2 id="defineandexporthealthcheckforprometheus">Define and Export Health Check for Prometheus</h2>

<h3 id="definehealthcheck">Define Health Check</h3>

<p>Extends <a href="https://github.com/strengthened">Strengthened</a>'s <a href="https://github.com/strengthened/prometheus-healthchecks/blob/master/src/main/java/com/github/strengthened/prometheus/healthchecks/HealthCheck.java">HealthCheck</a> and implements MySQL Database connection status checking method</p>

<pre><code class="language-java embedfile-https://github.com/hellokoding/hellokoding-courses/blob/master/java-examples/java-app-healthcheck-prometheus/src/main/java/com/hellokoding/monitoring/DbHealthCheck.java">
</code></pre>

<h3 id="exporthealthcheckforprometheus">Export Health Check for Prometheus</h3>

<p>Start a simple HTTP Sever by using <code>Jetty</code>, listening connection on port 8080 and expose health check through <code>/metrics</code> end point.</p>

<pre><code class="language-java embedfile-https://github.com/hellokoding/hellokoding-courses/blob/master/java-examples/java-app-healthcheck-prometheus/src/main/java/com/hellokoding/monitoring/HealthCheckExporter.java">
</code></pre>

<h2 id="gluethingstogether">Glue things together</h2>

<p>Create a <code>HealthChecksCollector</code> with metric name as <code>hello_koding_health_check</code> (to be use as a key to query on <code>Prometheus</code> and <code>Grafana</code>), add above health check definition to the collector and trigger <code>export</code> function.</p>

<pre><code class="language-markup embedfile-https://github.com/hellokoding/hellokoding-courses/blob/master/java-examples/java-app-healthcheck-prometheus/src/main/java/com/hellokoding/monitoring/Application.java">
</code></pre>

<p>Prepare <code>Dockerfile</code> to build the Java application</p>

<pre><code class="language-markup embedfile-https://github.com/hellokoding/hellokoding-courses/blob/master/java-examples/java-app-healthcheck-prometheus/Dockerfile">
</code></pre>

<p>Prepare <code>docker-compose.yaml</code> to provision MySQL, Prometheus and Grafana</p>

<pre><code class="language-bash embedfile-https://github.com/hellokoding/hellokoding-courses/blob/master/java-examples/java-app-healthcheck-prometheus/docker-compose.yaml">
</code></pre>

<p>Start your application and infrastructure via Docker Compose. Make sure your local Docker is running</p>

<pre><code>docker-compose up  
</code></pre>

<p>Access to <code>localhost:8080/metrics</code>, you should see something like this in the console</p>

<pre><code># HELP hello_koding_health_check Health check status results
# TYPE hello_koding_health_check gauge
hello_koding_health_check{system="database",} 1.0
</code></pre>

<p>Access to <code>Prometheus</code> console through <code>localhost:9090</code></p>

<p><img src="http://hellokoding.com/content/images/2019/01/Screenshot-2019-01-09-at-10-29-24-PM.png" alt="Java Application Health Check with Prometheus, Grafana, MySQL and Docker Compose"></p>

<p>And finally access to <code>Grafana</code> through <code>localhost:3000</code></p>

<p><img src="http://hellokoding.com/content/images/2019/01/Screenshot-2019-01-09-at-10-40-37-PM.png" alt="Java Application Health Check with Prometheus, Grafana, MySQL and Docker Compose"></p>

<h3 id="sourcecode">Source code</h3>

<p><a href="https://github.com/hellokoding/hellokoding-courses/tree/master/java-examples/java-app-healthcheck-prometheus">https://github.com/hellokoding/hellokoding-courses/tree/master/java-examples/java-app-healthcheck-prometheus</a></p>]]></content:encoded></item></channel></rss>